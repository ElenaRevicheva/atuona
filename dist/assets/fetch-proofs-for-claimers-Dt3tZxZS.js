const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/decimals-Zd1xIbKd.js","assets/main-DJ16BhX4.js"])))=>i.map(i=>d[i]);
import{aN as H,aO as k,ax as z,aC as q,L as g,aP as v,aQ as N,aR as O,af as S,aS as M,aT as j,aU as V,aV as W,T as w,aW as _,u as p,W as E,aX as Z,aY as $,aZ as B,Z as m,a_ as P,_ as y,e as A}from"./main-DJ16BhX4.js";import{download as D}from"./download-D83avpFf.js";import{t as F}from"./units-DR3SBGns.js";function Q(r,e){if(r.length!==e.length)throw new H({expectedLength:r.length,givenLength:e.length});const t=[];for(let a=0;a<r.length;a++){const n=r[a],c=e[a];t.push(T(n,c))}return k(t)}function T(r,e,t=!1){if(r==="address"){const s=e;if(!z(s))throw new q({address:s});return g(s.toLowerCase(),{size:t?32:null})}if(r==="string")return v(e);if(r==="bytes")return e;if(r==="bool")return g(N(e),{size:t?32:1});const a=r.match(O);if(a){const[s,i,l="256"]=a,o=Number.parseInt(l)/8;return S(e,{size:t?32:o,signed:i==="int"})}const n=r.match(M);if(n){const[s,i]=n;if(Number.parseInt(i)!==(e.length-2)/2)throw new j({expectedSize:Number.parseInt(i),givenSize:(e.length-2)/2});return g(e,{dir:"right",size:t?32:null})}const c=r.match(V);if(c&&Array.isArray(e)){const[s,i]=c,l=[];for(let o=0;o<e.length;o++)l.push(T(i,e[o],!0));return l.length===0?"0x":k(l)}throw new W(r)}class X{constructor(e){Object.defineProperty(this,"leaves",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"layers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.leaves=e.map(t=>t instanceof Uint8Array?t:w(t)),this.leaves=this.leaves.sort(_),this.createHashes(this.leaves)}getHexRoot(){return p(this.getRoot())}getHexProof(e,t){return this.getProof(e,t).map(a=>p(a.data))}createHashes(e){for(this.layers=[e];e.length>1;){const t=this.layers.length;this.layers.push([]);const a=e.length;for(let n=0;n<e.length;n+=2){if(n>=a){this.layers[t].push(...e.slice(a));break}if(n+1===e.length&&e.length%2===1){this.layers[t].push(e[n]);continue}const c=e[n],s=n+1===e.length?c:e[n+1],i=[c,s];i.sort(_);const l=E(Z(i),"bytes");this.layers[t].push(l)}e=this.layers[t]}}getRoot(){return this.layers.length===0?new Uint8Array:this.layers[this.layers.length-1][0]||new Uint8Array}getProof(e,t){if(typeof e>"u")throw new Error("leaf is required");e=e instanceof Uint8Array?e:w(e);const a=[];if(!Number.isInteger(t)){t=-1;for(let n=0;n<this.leaves.length;n++)$(e,this.leaves[n])&&(t=n)}if(t<=-1)return[];for(let n=0;n<this.layers.length;n++){const c=this.layers[n],s=t%2,i=s?t-1:t+1;i<c.length&&a.push({data:c[i],position:s?"left":"right"}),t=t/2|0}return a}}function f(r){const{quantity:e,tokenDecimals:t}=r;return e==="unlimited"?B:F(e,t)}async function Y(r){const e=r.entry.currencyAddress||m,t=await(async()=>{if(P(e)||e===m)return 18;const[{getContract:a},{decimals:n}]=await Promise.all([y(()=>import("./main-DJ16BhX4.js").then(s=>s.bd),[]),y(()=>import("./decimals-Zd1xIbKd.js"),__vite__mapDeps([0,1]))]),c=a({address:e,chain:r.chain,client:r.client});return await n({contract:c})})();return E(Q(["address","uint256","uint256","address"],[A(r.entry.address),f({quantity:r.entry.maxClaimable||"unlimited",tokenDecimals:r.tokenDecimals}),f({quantity:r.entry.price||"unlimited",tokenDecimals:t}),A(e)]))}async function ee(r){const{contract:e,merkleTreeUri:t,claimer:a}=r,n=r.hashEntry||Y,s=await(await D({client:e.client,uri:t})).json(),i=a.slice(2,2+s.shardNybbles).toLowerCase(),l=s.baseUri.endsWith("/")?s.baseUri:`${s.baseUri}/`;let o;try{const h=`${l}${i}.json`;o=await(await D({client:e.client,uri:h})).json()}catch{return null}const U=await Promise.all(o.entries.map(async h=>n({chain:e.chain,client:e.client,entry:h,tokenDecimals:r.tokenDecimals}))),x=new X(U),u=o.entries.find(h=>h.address.toLowerCase()===a.toLowerCase());if(!u)return null;const L=x.getHexProof(await n({chain:e.chain,client:e.client,entry:u,tokenDecimals:r.tokenDecimals})).concat(o.proofs),d=u.currencyAddress||m,R=await(async()=>{if(P(d)||d===m)return 18;const[{getContract:h},{decimals:b}]=await Promise.all([y(()=>import("./main-DJ16BhX4.js").then(C=>C.bd),[]),y(()=>import("./decimals-Zd1xIbKd.js"),__vite__mapDeps([0,1]))]),I=h({address:d,chain:e.chain,client:e.client});return await b({contract:I})})();return{currency:d,pricePerToken:f({quantity:u.price||"unlimited",tokenDecimals:R}),proof:L,quantityLimitPerWallet:f({quantity:u.maxClaimable||"unlimited",tokenDecimals:r.tokenDecimals})}}export{ee as fetchProofsForClaimer};
