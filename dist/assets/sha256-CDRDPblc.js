import{aR as m,aS as _,aT as C,aD as E,aU as I,aV as y,aW as w,aX as D,aY as T,aZ as S,a_ as B,a$ as F,b0 as x,b1 as G,b2 as k,b3 as R}from"./main-DpsjE5QK.js";function A(i,t="hex"){const s=H(i),n=m(new Uint8Array(s.length));return s.encode(n),t==="hex"?_(n.bytes):n.bytes}function Z(i,t="bytes"){return A(i,t)}function q(i,t="hex"){return A(i,t)}function H(i){return Array.isArray(i)?V(i.map(t=>H(t))):W(i)}function V(i){const t=i.reduce((e,o)=>e+o.length,0),s=L(t);return{length:t<=55?1+t:1+s+t,encode(e){t<=55?e.pushByte(192+t):(e.pushByte(247+s),s===1?e.pushUint8(t):s===2?e.pushUint16(t):s===3?e.pushUint24(t):e.pushUint32(t));for(const{encode:o}of i)o(e)}}}function W(i){const t=typeof i=="string"?C(i):i,s=L(t.length);return{length:t.length===1&&t[0]<128?1:t.length<=55?1+t.length:1+s+t.length,encode(e){t.length===1&&t[0]<128?e.pushBytes(t):t.length<=55?(e.pushByte(128+t.length),e.pushBytes(t)):(e.pushByte(183+s),s===1?e.pushUint8(t.length):s===2?e.pushUint16(t.length):s===3?e.pushUint24(t.length):e.pushUint32(t.length),e.pushBytes(t))}}}function L(i){if(i<2**8)return 1;if(i<2**16)return 2;if(i<2**24)return 3;if(i<2**32)return 4;throw new E("Length is too large.")}function $(i,t,s,n){if(typeof i.setBigUint64=="function")return i.setBigUint64(t,s,n);const e=BigInt(32),o=BigInt(4294967295),h=Number(s>>e&o),f=Number(s&o),a=n?4:0,r=n?0:4;i.setUint32(t+a,h,n),i.setUint32(t+r,f,n)}function z(i,t,s){return i&t^~i&s}function M(i,t,s){return i&t^i&s^t&s}class N extends I{constructor(t,s,n,e){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=s,this.padOffset=n,this.isLE=e,this.buffer=new Uint8Array(t),this.view=y(this.buffer)}update(t){w(this),t=D(t),T(t);const{view:s,buffer:n,blockLen:e}=this,o=t.length;for(let h=0;h<o;){const f=Math.min(e-this.pos,o-h);if(f===e){const a=y(t);for(;e<=o-h;h+=e)this.process(a,h);continue}n.set(t.subarray(h,h+f),this.pos),this.pos+=f,h+=f,this.pos===e&&(this.process(s,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){w(this),S(t,this),this.finished=!0;const{buffer:s,view:n,blockLen:e,isLE:o}=this;let{pos:h}=this;s[h++]=128,B(this.buffer.subarray(h)),this.padOffset>e-h&&(this.process(n,0),h=0);for(let c=h;c<e;c++)s[c]=0;$(n,e-8,BigInt(this.length*8),o),this.process(n,0);const f=y(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const r=a/4,u=this.get();if(r>u.length)throw new Error("_sha2: outputLen bigger than state");for(let c=0;c<r;c++)f.setUint32(4*c,u[c],o)}digest(){const{buffer:t,outputLen:s}=this;this.digestInto(t);const n=t.slice(0,s);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:s,buffer:n,length:e,finished:o,destroyed:h,pos:f}=this;return t.destroyed=h,t.finished=o,t.length=e,t.pos=f,e%s&&t.buffer.set(n),t}clone(){return this._cloneInto()}}const b=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),j=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),l=new Uint32Array(64);class K extends N{constructor(t=32){super(64,t,8,!1),this.A=b[0]|0,this.B=b[1]|0,this.C=b[2]|0,this.D=b[3]|0,this.E=b[4]|0,this.F=b[5]|0,this.G=b[6]|0,this.H=b[7]|0}get(){const{A:t,B:s,C:n,D:e,E:o,F:h,G:f,H:a}=this;return[t,s,n,e,o,h,f,a]}set(t,s,n,e,o,h,f,a){this.A=t|0,this.B=s|0,this.C=n|0,this.D=e|0,this.E=o|0,this.F=h|0,this.G=f|0,this.H=a|0}process(t,s){for(let c=0;c<16;c++,s+=4)l[c]=t.getUint32(s,!1);for(let c=16;c<64;c++){const d=l[c-15],g=l[c-2],U=x(d,7)^x(d,18)^d>>>3,p=x(g,17)^x(g,19)^g>>>10;l[c]=p+l[c-7]+U+l[c-16]|0}let{A:n,B:e,C:o,D:h,E:f,F:a,G:r,H:u}=this;for(let c=0;c<64;c++){const d=x(f,6)^x(f,11)^x(f,25),g=u+d+z(f,a,r)+j[c]+l[c]|0,p=(x(n,2)^x(n,13)^x(n,22))+M(n,e,o)|0;u=r,r=a,a=f,f=h+g|0,h=o,o=e,e=n,n=g+p|0}n=n+this.A|0,e=e+this.B|0,o=o+this.C|0,h=h+this.D|0,f=f+this.E|0,a=a+this.F|0,r=r+this.G|0,u=u+this.H|0,this.set(n,e,o,h,f,a,r,u)}roundClean(){B(l)}destroy(){this.set(0,0,0,0,0,0,0,0),B(this.buffer)}}const O=F(()=>new K),X=O;function J(i,t){const s=t||"hex",n=X(k(i,{strict:!1})?G(i):i);return s==="bytes"?n:R(n)}export{N as H,O as a,Z as b,q as h,J as s,A as t};
