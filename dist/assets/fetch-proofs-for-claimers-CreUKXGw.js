const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/decimals-BjFHW1Cf.js","assets/main-DByEKx5X.js"])))=>i.map(i=>d[i]);
import{B as v,L as H,c as S,A as z,p as m,s as N,b as q,n as B,a as M,U as O,h as w,d as A,u as _,k as E,e as j,f as F,Z as f,i as x,_ as g,g as k}from"./main-DByEKx5X.js";import{download as D}from"./download-DaQkh2Hm.js";class V extends v{constructor({address:t}){super(`Address "${t}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}const W=/^0x[a-fA-F0-9]{40}$/,b=new H(8192);function Z(r,t){const{strict:e=!0}={},n=`${r}.${e}`;if(b.has(n))return b.get(n);const s=W.test(r)?r.toLowerCase()===r?!0:e?S(r)===r:!0:!1;return b.set(n,s),s}function P(r){return`0x${r.reduce((t,e)=>t+e.replace("0x",""),"")}`}const K=/^(.*)\[([0-9]*)\]$/,Q=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,G=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function J(r,t){if(r.length!==t.length)throw new z({expectedLength:r.length,givenLength:t.length});const e=[];for(let n=0;n<r.length;n++){const s=r[n],a=t[n];e.push(I(s,a))}return P(e)}function I(r,t,e=!1){if(r==="address"){const i=t;if(!Z(i))throw new V({address:i});return m(i.toLowerCase(),{size:e?32:null})}if(r==="string")return N(t);if(r==="bytes")return t;if(r==="bool")return m(q(t),{size:e?32:1});const n=r.match(G);if(n){const[i,c,l="256"]=n,o=Number.parseInt(l)/8;return B(t,{size:e?32:o,signed:c==="int"})}const s=r.match(Q);if(s){const[i,c]=s;if(Number.parseInt(c)!==(t.length-2)/2)throw new M({expectedSize:Number.parseInt(c),givenSize:(t.length-2)/2});return m(t,{dir:"right",size:e?32:null})}const a=r.match(K);if(a&&Array.isArray(t)){const[i,c]=a,l=[];for(let o=0;o<t.length;o++)l.push(I(c,t[o],!0));return l.length===0?"0x":P(l)}throw new O(r)}function X(r,t){let[e,n=""]=r.split(".");const s=e.startsWith("-")?"-":"";if(s&&(e=e.slice(1)),n=n.padEnd(t,"0"),t===0)n[0]&&Number.parseInt(n[0])>=5&&(e=(BigInt(e)+1n).toString()),n="";else if(n.length>t){const a=n[t];a&&Number.parseInt(a,10)>=5?(n=(BigInt(n.substring(0,t))+1n).toString().padStart(t,"0"),n.length>t&&(e=(BigInt(e)+1n).toString(),n=n.substring(n.length-t))):n=n.substring(0,t)}return BigInt(`${s}${e}${n}`)}const Y=2n**256n-1n;class tt{constructor(t){Object.defineProperty(this,"leaves",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"layers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.leaves=t.map(e=>e instanceof Uint8Array?e:w(e)),this.leaves=this.leaves.sort(A),this.createHashes(this.leaves)}getHexRoot(){return _(this.getRoot())}getHexProof(t,e){return this.getProof(t,e).map(n=>_(n.data))}createHashes(t){for(this.layers=[t];t.length>1;){const e=this.layers.length;this.layers.push([]);const n=t.length;for(let s=0;s<t.length;s+=2){if(s>=n){this.layers[e].push(...t.slice(n));break}if(s+1===t.length&&t.length%2===1){this.layers[e].push(t[s]);continue}const a=t[s],i=s+1===t.length?a:t[s+1],c=[a,i];c.sort(A);const l=E(j(c),"bytes");this.layers[e].push(l)}t=this.layers[e]}}getRoot(){return this.layers.length===0?new Uint8Array:this.layers[this.layers.length-1][0]||new Uint8Array}getProof(t,e){if(typeof t>"u")throw new Error("leaf is required");t=t instanceof Uint8Array?t:w(t);const n=[];if(!Number.isInteger(e)){e=-1;for(let s=0;s<this.leaves.length;s++)F(t,this.leaves[s])&&(e=s)}if(e<=-1)return[];for(let s=0;s<this.layers.length;s++){const a=this.layers[s],i=e%2,c=i?e-1:e+1;c<a.length&&n.push({data:a[c],position:i?"left":"right"}),e=e/2|0}return n}}function y(r){const{quantity:t,tokenDecimals:e}=r;return t==="unlimited"?Y:X(t,e)}async function et(r){const t=r.entry.currencyAddress||f,e=await(async()=>{if(x(t)||t===f)return 18;const[{getContract:n},{decimals:s}]=await Promise.all([g(()=>import("./main-DByEKx5X.js").then(i=>i.l),[]),g(()=>import("./decimals-BjFHW1Cf.js"),__vite__mapDeps([0,1]))]),a=n({address:t,chain:r.chain,client:r.client});return await s({contract:a})})();return E(J(["address","uint256","uint256","address"],[k(r.entry.address),y({quantity:r.entry.maxClaimable||"unlimited",tokenDecimals:r.tokenDecimals}),y({quantity:r.entry.price||"unlimited",tokenDecimals:e}),k(t)]))}async function st(r){const{contract:t,merkleTreeUri:e,claimer:n}=r,s=r.hashEntry||et,i=await(await D({client:t.client,uri:e})).json(),c=n.slice(2,2+i.shardNybbles).toLowerCase(),l=i.baseUri.endsWith("/")?i.baseUri:`${i.baseUri}/`;let o;try{const u=`${l}${c}.json`;o=await(await D({client:t.client,uri:u})).json()}catch{return null}const L=await Promise.all(o.entries.map(async u=>s({chain:t.chain,client:t.client,entry:u,tokenDecimals:r.tokenDecimals}))),T=new tt(L),h=o.entries.find(u=>u.address.toLowerCase()===n.toLowerCase());if(!h)return null;const U=T.getHexProof(await s({chain:t.chain,client:t.client,entry:h,tokenDecimals:r.tokenDecimals})).concat(o.proofs),d=h.currencyAddress||f,R=await(async()=>{if(x(d)||d===f)return 18;const[{getContract:u},{decimals:p}]=await Promise.all([g(()=>import("./main-DByEKx5X.js").then(C=>C.l),[]),g(()=>import("./decimals-BjFHW1Cf.js"),__vite__mapDeps([0,1]))]),$=u({address:d,chain:t.chain,client:t.client});return await p({contract:$})})();return{currency:d,pricePerToken:y({quantity:h.price||"unlimited",tokenDecimals:R}),proof:U,quantityLimitPerWallet:y({quantity:h.maxClaimable||"unlimited",tokenDecimals:r.tokenDecimals})}}export{st as fetchProofsForClaimer};
